!function(){"use strict";const e=e=>Object.keys(e).sort().reduce(((t,i)=>(t[i]=e[i],t)),{}),t=e=>e.replace(/\_/g," "),i=(()=>{let e=[];return window.CONFIG.locations.forEach((t=>{let i=t.replace(/(\t+)/,"\t").split("\t");1===i.length&&i.push(""),e.push(i)})),e})();class s{constructor(){let e=[];i.forEach((t=>{e.push(t[0])})),this.tzList=e,this.labels={add:{select:"Add City/Region",submit:"Add"},changeHome:"Make Home"}}newTZ(e){this.dateObj=new Date,this.home=localStorage.getItem("home")||window.CONFIG.home,this.eventTypeIs(e,"load")&&(localStorage.getItem("tz")||localStorage.setItem("tz",this.home),localStorage.getItem("home")||localStorage.setItem("home",this.home)),this.userTZ=localStorage.getItem("tz").split("|")}eventTypeIs(e,t){return void 0!==e&&e.type===t}convertTo12Hour(e){let t="AM";return 0<e&&e>12?(e-=12,t="PM"):0===e&&(e=12,t="AM"),{hour:e,period:t}}UTC(){return{date:this.dateObj,hours:this.dateObj.getUTCHours(),minutes:this.dateObj.getUTCMinutes(),unix:Math.floor(Date.now()/1e3)+60*this.dateObj.getTimezoneOffset()}}localTime(){return{date:this.dateObj,hours:this.dateObj.getHours(),minutes:this.dateObj.getMinutes(),unix:Math.floor(Date.now()/1e3)}}table(){let t="",i={};this.userTZ.forEach((e=>{let t=this.definedTime(e),s=t.unix+t.niceName;i[s]=t})),i=e(i),Object.keys(i).forEach((e=>{let s=i[e],o=this.convertTo12Hour(s.h,s.m),n=`<button data-id="${s.name}" class="btn delete" title="Delete Timezone"></button>`,a=this.home===s.name?'disabled="disabled"':"",l=`<th class="name"><div>${n+`<button data-id="${s.name}" title="Make this home" ${a} class="home" id="add_as_home">${this.labels.changeHome}</button>`+s.niceName}</div></th>`,d=`<th class="current_time"><div>${o.hour}:${s.m} ${o.period}</span></th>`,r=`<th class="offset"><div>${s.offsets.str}</div></th>`,m="";s.increment.forEach((e=>{let t=s.offsets.m.toString().replace(/-/g,"").padStart(2,"0");m+=`<td class="inc"><div><span class="hour">${this.convertTo12Hour(e).hour}</span>:<span class="minutes">${t}</span></div></td>`}));let h=[l,r,d,m].join("");t+=`<tr class="${s.isHome?"current":""}">${h}</tr>`})),document.getElementById("table_wrapper").innerHTML=`<table id="table" cellspacing="0">${t}</table>`}isValidTimeZone(e){if(!Intl||!Intl.DateTimeFormat().resolvedOptions().timeZone)throw new Error("Time zones are not available in this environment");try{return Intl.DateTimeFormat(void 0,{timeZone:e}),!0}catch(e){return!1}}definedTime(e,i){if(!this.isValidTimeZone(e))return console.log(`Invalid timezone: ${e}`),{};let s=new Date(this.dateObj.toLocaleString("en-US",{timeZone:e})),o=this.UTC(),n=s.getTime()/1e3,a="",l="Â±",d=s.getHours(),r=s.getMinutes(),m=d,h=0,c=[],u={h:Math.floor((n-o.unix)/3600),m:Math.round((n-o.unix)/60%60)},b=n-o.unix;this.date=s,60===u.m&&(u.m=0,b<0?u.h--:b>0&&u.h++),b<0?l="-":b>0&&(l="+"),Object.keys(u).forEach((e=>{let i=t(u[e].toString().replace(/\-/,""));a+=i.padStart(2,"0")})),u.str=l+a;for(let e=0;e<24;e++)m+h>23&&(m=0,h=0),c.push(m+h),h++;let g={name:e,niceName:t(e),h:d,m:r.toString().padStart(2,"0"),obj:s,unix:n,offsets:u,increment:c,isHome:e===this.home};return void 0!==i?g[i]:g}getList(){let t={};this.tzList.forEach((e=>{if(this.userTZ.indexOf(e)<=-1){let i=[this.definedTime(e,"unix"),e].join("__");t[i]=e}})),this.sortedList=e(t)}form__ADD(){let e=[];this.getList(),e.push(`<option value="--" selected="selected">${this.labels.add.select}</option>`),Object.keys(this.sortedList).forEach((i=>{let s=this.sortedList[i];if(this.userTZ.indexOf(s)<=-1){let i=this.definedTime(s,"offsets").str;e.push(`<option value="${s}">(GMT ${i}) ${t(s)}</option>`)}}));let i=`<button type="submit" disabled="disabled" class="add" id="add_timezone_btn">${this.labels.add.submit}</button>`,s=`<select id="timezone_list" name="timezone_list">${e.join("")}</select>`;document.getElementById("add_timezone_inner").innerHTML=i+s}add(){let e=document.getElementById("timezone_list").value;if("--"!==e){let t=localStorage.getItem("tz").split("|");t.push(e),localStorage.setItem("tz",t.join("|")),this.newTZ(),this.form__ADD(),this.table()}}changeHome(e){localStorage.setItem("home",e),this.newTZ(),this.table()}remove(e){let t=this.userTZ;t.splice(t.indexOf(e),1),localStorage.setItem("tz",t.join("|")),this.newTZ(),this.form__ADD(),this.table()}}!function(){const e=new s;window.onload=t=>{e.newTZ(t),e.table(),e.form__ADD(),document.getElementById("add_timezone").onsubmit=function(e){e.preventDefault()};let i=e=>{"--"!==e.value?document.getElementById("add_timezone_btn").removeAttribute("disabled"):document.getElementById("add_timezone_btn").setAttribute("disabled","disabled")};document.addEventListener("click",(function(t){let s=t.target;if(s){let t=s.classList.value,o=s.getAttribute("data-id");s.classList.value.match(/(^| )delete( |$)/)?e.remove(o):t.match(/(^| )home( |$)/)&&!s.getAttribute("disabled")?e.changeHome(o):"add_timezone_btn"===s.id?e.add():"timezone_list"===s.id&&i(s)}t.preventDefault()})),document.addEventListener("change",(function(e){let t=e.target;"timezone_list"===t.id&&i(t)})),setInterval((()=>{e.newTZ(t),e.table()}),2e3)}}()}();