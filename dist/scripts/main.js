!function(){"use strict";const e=e=>Object.keys(e).sort().reduce(((t,i)=>(t[i]=e[i],t)),{}),t=e=>e.replace(/\_/g," "),i=(()=>{let e=[];return window.CONFIG.locations.forEach((t=>{let i=t.replace(/(\t+)/,"\t").split("\t");1===i.length&&i.push(""),e.push(i)})),e})();class o{constructor(){let e=[];i.forEach((t=>{e.push(t[0])})),this.tzList=e}newTZ(e){this.dateObj=new Date,this.home=localStorage.getItem("home")||window.CONFIG.home,this.eventTypeIs(e,"load")&&(localStorage.getItem("tz")||localStorage.setItem("tz",this.home),localStorage.getItem("home")||localStorage.setItem("home",this.home)),this.userTZ=localStorage.getItem("tz").split("|")}eventTypeIs(e,t){return void 0!==e&&e.type===t}convertTo12Hour(e){let t="AM";return 0<e&&e>12?(e-=12,t="PM"):0===e&&(e=12,t="AM"),{hour:e,period:t}}UTC(){return{date:this.dateObj,hours:this.dateObj.getUTCHours(),minutes:this.dateObj.getUTCMinutes(),unix:Math.floor(Date.now()/1e3)+60*this.dateObj.getTimezoneOffset()}}localTime(){return{date:this.dateObj,hours:this.dateObj.getHours(),minutes:this.dateObj.getMinutes(),unix:Math.floor(Date.now()/1e3)}}table(){let t="",i={};this.userTZ.forEach((e=>{let t=this.definedTime(e),o=t.unix+t.niceName;i[o]=t})),i=e(i),Object.keys(i).forEach((e=>{let o=i[e],s=this.convertTo12Hour(o.h,o.m),n=`<button data-id="${o.name}" class="btn delete" title="Delete Timezone"></button>`,a=this.home===o.name?'disabled="disabled"':"",l=`<th class="name"><div>${n+`<button data-id="${o.name}" title="Make this home" ${a} class="home" id="add_as_home">Make Home</button>`+o.niceName}</div></th>`,d=`<th class="current_time"><div>${s.hour}:${o.m} ${s.period}</span></th>`,r=`<th class="offset"><div>${o.offsets.str}</div></th>`,m="";o.increment.forEach((e=>{let t=o.offsets.m.toString().replace(/-/g,"").padStart(2,"0");m+=`<td class="inc"><div><span class="hour">${this.convertTo12Hour(e).hour}</span>:<span class="minutes">${t}</span></div></td>`}));let h=[l,r,d,m].join("");t+=`<tr class="${o.isHome?"current":""}">${h}</tr>`})),document.getElementById("table_wrapper").innerHTML=`<table id="table" cellspacing="0">${t}</table>`}isValidTimeZone(e){if(!Intl||!Intl.DateTimeFormat().resolvedOptions().timeZone)throw new Error("Time zones are not available in this environment");try{return Intl.DateTimeFormat(void 0,{timeZone:e}),!0}catch(e){return!1}}definedTime(e,i){if(!this.isValidTimeZone(e))return console.log(`Invalid timezone: ${e}`),{};let o=new Date(this.dateObj.toLocaleString("en-US",{timeZone:e})),s=this.UTC(),n=o.getTime()/1e3,a="",l="Â±",d=o.getHours(),r=o.getMinutes(),m=d,h=0,c=[],u={h:Math.floor((n-s.unix)/3600),m:Math.round((n-s.unix)/60%60)},b=n-s.unix;this.date=o,60===u.m&&(u.m=0,b<0?u.h--:b>0&&u.h++),b<0?l="-":b>0&&(l="+"),Object.keys(u).forEach((e=>{let i=t(u[e].toString().replace(/\-/,""));a+=i.padStart(2,"0")})),u.str=l+a;for(let e=0;e<24;e++)m+h>23&&(m=0,h=0),c.push(m+h),h++;let f={name:e,niceName:t(e),h:d,m:r.toString().padStart(2,"0"),obj:o,unix:n,offsets:u,increment:c,isHome:e===this.home};return void 0!==i?f[i]:f}getList(){let t={};this.tzList.forEach((e=>{if(this.userTZ.indexOf(e)<=-1){let i=[this.definedTime(e,"unix"),e].join("__");t[i]=e}})),this.sortedList=e(t)}form__ADD(){let e=[];this.getList(),e.push('<option value="--" selected="selected">Add City</option>'),Object.keys(this.sortedList).forEach((i=>{let o=this.sortedList[i];if(this.userTZ.indexOf(o)<=-1){let i=this.definedTime(o,"offsets").str;e.push(`<option value="${o}">(GMT ${i}) ${t(o)}</option>`)}}));let i=`<select id="timezone_list" name="timezone_list">${e.join("")}</select>`;document.getElementById("add_timezone_inner").innerHTML='<button type="submit" disabled="disabled" class="add" id="add_timezone_btn">Add</button>'+i}add(){let e=document.getElementById("timezone_list").value;if("--"!==e){let t=localStorage.getItem("tz").split("|");t.push(e),localStorage.setItem("tz",t.join("|")),this.newTZ(),this.form__ADD(),this.table()}}changeHome(e){localStorage.setItem("home",e),this.newTZ(),this.table()}remove(e){let t=this.userTZ;t.splice(t.indexOf(e),1),localStorage.setItem("tz",t.join("|")),this.newTZ(),this.form__ADD(),this.table()}}!function(){const e=new o;window.onload=t=>{e.newTZ(t),e.table(),e.form__ADD(),document.getElementById("add_timezone").onsubmit=function(e){e.preventDefault()};let i=e=>{"--"!==e.value?document.getElementById("add_timezone_btn").removeAttribute("disabled"):document.getElementById("add_timezone_btn").setAttribute("disabled","disabled")};document.addEventListener("click",(function(t){let o=t.target;if(o){let t=o.classList.value,s=o.getAttribute("data-id");o.classList.value.match(/(^| )delete( |$)/)?e.remove(s):t.match(/(^| )home( |$)/)&&!o.getAttribute("disabled")?e.changeHome(s):"add_timezone_btn"===o.id?e.add():"timezone_list"===o.id&&i(o)}t.preventDefault()})),document.addEventListener("change",(function(e){let t=e.target;"timezone_list"===t.id&&i(t)})),setInterval((()=>{e.newTZ(t),e.table()}),2e3)}}()}();